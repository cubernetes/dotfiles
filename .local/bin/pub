#! /bin/sh -

err () {
	printf '\033[31m%s\033[m\n' "$*"
}

trap 'rm -f "$file"' EXIT

[ ! -t 0 ] && [ -z "$1" ] && file=$(mktemp) && cat >"$file" || [ -n "$1" ] && file="$1"

# mia's 0x0.st -- fast! -- prints \n
# curl -sfSL -F"file=@$file" 0x0.st && exit 0 ; err "Mia's (0x0.st) pastebin failed!"

# pb1n.de -- fast! -- prints \n
# curl -sfSL -F"f=@$file" pb1n.de && exit 0 ; err "pb1n.de pastebin failed!"

# chris titus' hastebin -- not that fast -- prints \n
# response="$(curl -sfSL --data-binary @"$file" bin.christitus.com/documents)" &&
# 	{ hasteKey="$(printf %s "$response" | jq -r '.key')" && [ -n "${hasteKey}" ] &&
# 		echo "http://bin.christitus.com/raw/$hasteKey" && exit 0 || err "Couldn't extract hasteKey. Sorry!"; }
# err "Chris' pastebin failed!"

# paste.rs -- damn slow -- prints without \n
# curl -sfSL --data-binary @"$file" paste.rs && exit 0 ; err "paste.rs pastebin failed!"

# transfer.sh -- requires https -- not that fast -- prints \n
curl -sfSL --upload-file "$file" https://transfer.sh && exit 0 ; err "transfer.sh pastebin failed!"

# clbin.com -- requires https -- not that fast -- prints \n
curl -sfSL -F"clbin=<$file" https://clbin.com && exit 0 ; err "clbin.com pastebin failed!"

# sprunge.us -- RIP
curl -sfSL -F"sprunge=<$file" http://sprunge.us && exit 0 ; err "sprunge.us pastebin failed!"

# ix.io, "taking a break" -- RIP
curl -sfSL -F"f:1=<$file" ix.io && exit 0 ; err "ix.io pastebin failed!"
